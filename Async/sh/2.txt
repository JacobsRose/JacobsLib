--@name libs/jacobs/Async/sh/2.txt
local function Async(func)
    return function(...)

        local parent = coroutine.running()
        local thread = coroutine.create(func)
        local isYielded = false
        local results

        local function callback(...)
            results = {...}
            if isYielded then
                coroutine.resume(parent, unpack(results))
            end
        end

        coroutine.resume(thread, callback, ...)

        if results == nil then
            return function()
                isYielded = true
                return coroutine.yield()
            end
        else
            return function()
                return unpack(results)
            end
        end

    end
end
return Async
